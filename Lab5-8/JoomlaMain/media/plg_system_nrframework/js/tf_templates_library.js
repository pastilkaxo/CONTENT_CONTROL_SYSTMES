var TF_Templates_Library_Filters=function(){function e(e){this.instance=e,this.filtersPillsClass=".tf-library-selected-filters-pills",this.filterItemClass=".tf-library-filter-item",this.initEvents()}var t=e.prototype;return t.initEvents=function(){document.addEventListener("click",function(e){this.initFilterItemToggle(e),this.onClearAllFilters(e),this.onRemoveFilterPillItem(e)}.bind(this)),document.addEventListener("change",function(e){this.onFilterItemSelect(e)}.bind(this))},t.initFilterItemToggle=function(e){var t=e.target.closest(".tf-library-filter-item-label");t&&(e.preventDefault(),t.closest(this.filterItemClass).classList.toggle("open"))},t.onFilterItemSelect=function(e){e.target.closest(".tf-library-filter-choice-item-checkbox")&&this.update()},t.update=function(){var e=this.instance.filters_sidebar.querySelectorAll(".tf-library-filter-item"),o=[],l=(e.forEach(function(t){var e=t.querySelectorAll('input[type="checkbox"]:checked');o[t.dataset.type]=[],e.forEach(function(e){o[t.dataset.type].push(e.value)})}),Object.values(o).every(function(e){return 0===e.length}));l?(this.setNoFilters(),o=[]):this.setHasFilters(),o&&this.instance.items.getCurrentItems().forEach(function(e){var t=e.dataset.filterCategory,i=e.dataset.filterSolution,r=e.dataset.filterGoal,s=e.dataset.filterCompatibility,a=e.dataset.filterTags,n=!!l;for(key in o)if(0!==o[key].length){if("category"===key&&(""===t&&(n=!1),!(n=o[key].includes(t)||t.includes(o[key]))))break;if("solution"===key&&(""===i&&(n=!1),!(n=o[key].includes(i))))break;if("goal"===key&&(""===r&&(n=!1),!(n=o[key].includes(r))))break;if("compatibility"===key&&(""===s&&(n=!1),!(n=o[key].includes(s))))break;if("tags"===key){for(tag in""===a&&(n=!1),o[key]){if(-1!==a.indexOf(o[key][tag])){n=!0;break}n=!1}if(!n)break}}n?e.classList.remove("is-hidden"):e.classList.add("is-hidden")}),this.instance.search.search(),this.instance.sorting.sort()},t.onUpdateSearchElements=function(){var i=this,r=(this.emptyFilterPills(),this.getFilterPillsWrapper());this.instance.filters_sidebar.querySelectorAll('input[type="checkbox"]:checked').forEach(function(e){var t=i.instance.library_wrapper.querySelector(".tf-library-filter-template").cloneNode(!0);t.querySelector(".filter").dataset.filter=e.value,t.querySelector(".filter .filter-label").innerHTML=e.value,r.appendChild(t.children[0])})},t.emptyFilterPills=function(){this.getFilterPillsWrapper().innerHTML=""},t.getFilterPillsWrapper=function(){return this.instance.library_wrapper.querySelector(this.filtersPillsClass)},t.onClearAllFilters=function(e){e.target.closest(".tf-library-filters-clear-all")&&(e.preventDefault(),this.instance.library_toolbar.querySelector(".tf-library-search input").value="",this.instance.filters_sidebar.querySelectorAll('input[type="checkbox"]:checked').forEach(function(e){e.checked=!1}),this.update())},t.onRemoveFilterPillItem=function(e){var t=e.target.closest(".tf-library-filter-pill-item-remove");t&&(e.preventDefault(),e=t.closest(".filter").dataset.filter,this.instance.filters_sidebar.querySelectorAll('input[type="checkbox"][value="'+e+'"]:checked').forEach(function(e){e.checked=!1}),this.update())},t.setHasFilters=function(){this.instance.library_wrapper.classList.add("has-filters")},t.setNoFilters=function(){this.instance.library_wrapper.classList.remove("has-filters")},e}(),TF_Templates_Info_Modal=function(){function e(e){this.instance=e,this.modal=document.querySelector("#tf-library-item-info-popup"),this.initEvents()}var t=e.prototype;return t.initEvents=function(){document.addEventListener("click",function(e){this.onBeforeOpen(e)}.bind(this))},t.onBeforeOpen=function(e){var i,r,s,a=this,t=e.target.closest('[data-bs-target="#tf-library-item-info-popup"]'),n=e.target.closest(".tf-library-template-item-info-popup-trigger");(t||n)&&(t=t||n||!1)&&(n&&(e.preventDefault(),jQuery(this.modal).modal("show")),n=this.instance.getTemplateItem(t),i=n.querySelector(".info-popup-actions"),(r=this.modal.querySelector(".dependency-items")).innerHTML="",e=JSON.parse(n.dataset.capabilities),this.modal.querySelector(".modal-header > h3").innerHTML=n.querySelector(".template-label").innerHTML,this.modal.querySelector(".item-description").innerHTML=n.dataset.note,this.modal.querySelector(".template-details").querySelector(".category > .content").innerHTML=e.category.value||"-",this.modal.querySelector(".template-details").querySelector(".solution > .content").innerHTML=e.solution.value||"-",this.modal.querySelector(".template-details").querySelector(".goal > .content").innerHTML=e.goal.value||"-",(s=this.modal.querySelector(".dependency-item.template").cloneNode(!0)).classList.remove("template"),s.querySelector(".requirement").innerHTML=this.instance.getOption("project_name")+" "+("pro"===e.pro.requirement?this.instance.getOption("pro"):this.instance.getOption("lite")),s.querySelector(".detected").innerHTML=this.instance.getOption("project_name")+" "+this.instance.getOption(e.pro.detected),"pro"===e.pro.requirement&&"pro"!==e.pro.detected?s.querySelector(".value").appendChild(i.querySelector("a.pro").cloneNode(!0)):s.classList.add("pass"),r.appendChild(s),(s=this.modal.querySelector(".dependency-item.template").cloneNode(!0)).classList.remove("template"),s.querySelector(".requirement").innerHTML="Joomla! "+e.joomla.value+"+",s.querySelector(".detected").innerHTML="Joomla! "+e.joomla.detected,""!==e.joomla.icon?s.querySelector(".value").appendChild(i.querySelector("a.joomla").cloneNode(!0)):s.classList.add("pass"),r.appendChild(s),(s=this.modal.querySelector(".dependency-item.template").cloneNode(!0)).classList.remove("template"),s.querySelector(".requirement").innerHTML=this.instance.getOption("project_name")+" "+e.project.value+"+",s.querySelector(".detected").innerHTML=this.instance.getOption("project_name")+" "+e.project.detected,""!==e.project.icon?(s.querySelector(".value").appendChild(i.querySelector("a.project").cloneNode(!0)),s.querySelector(".value a .short-label").innerHTML=this.instance.getOption("update_extension")):s.classList.add("pass"),r.appendChild(s),e.third_party_dependencies.value&&e.third_party_dependencies.value.forEach(function(e,t){(s=a.modal.querySelector(".dependency-item.template").cloneNode(!0)).classList.remove("template"),s.querySelector(".requirement").innerHTML=e.name+" "+e.version+"+",s.querySelector(".detected").innerHTML="none"===e.detected?"-":e.name+" "+e.detected,e.valid?s.classList.add("pass"):(s.querySelector(".value").appendChild(i.querySelector("a.third_party_dependencies_"+t).cloneNode(!0)),s.querySelector(".value a .short-label").innerHTML="update"===e.icon?a.instance.getOption("update_extension"):a.instance.getOption("install_extension")),r.appendChild(s)}),""!==e.license_error.value)&&((s=this.modal.querySelector(".dependency-item.template").cloneNode(!0)).classList.remove("template"),s.querySelector(".requirement").innerHTML=this.instance.getOption("license_key"),s.querySelector(".detected").innerHTML="missing"===e.license_error.value?"-":this.instance.getOption("license"),s.querySelector(".value").appendChild(i.querySelector("a.license").cloneNode(!0)),r.appendChild(s))},e}(),TF_Templates_Library_Items=function(){function e(e){this.instance=e,this.initEvents()}var t=e.prototype;return t.initEvents=function(){document.addEventListener("click",function(e){this.onCloseItemMessage(e),this.onFavorite(e),this.onInsert(e)}.bind(this))},t.onCloseItemMessage=function(e){e=e.target.closest(".fpf-library-messages-hide-btn");e&&e.closest(".tf-template-item-message").classList.add("is-hidden")},t.onFavorite=function(e){var i,r,s=e.target.closest(".tf-library-favorite-item");s&&(e.preventDefault(),s.classList.add("working"),i=e.target.closest(".tf-library-item").dataset.id,(r=this).instance.ajaxCall("favorites_toggle",{template_id:i},function(e){var e=Object.keys(e).includes(i),t=document.querySelector(".tf-library-item[data-id='"+i+"'] .tf-library-favorite-item");s.classList.remove("working"),e?t.classList.add("active"):(t.classList.remove("active"),r.instance.filters.update())}))},t.onInsert=function(e){var t,i,r,s=e.target.closest(".tf-library-item-insert-btn");s&&(t=s.dataset.templateId)&&(e.preventDefault(),i=s.closest(".tf-library-item"),document.body.classList.add("tf-templates-library-inserting"),i&&i.classList.add("inserting-template"),this.instance.hideMessageAlert(),s.classList.add("working"),(r=this).instance.ajaxCall("insert_template",{template_id:t},function(e){e.error?r.instance.previewModal.classList.contains("fade")&&(r.instance.previewModal.classList.contains("in")||r.instance.previewModal.classList.contains("show"))?(r.instance.showMessageAlert(e.message),r.instance.modal.querySelector(".tf-library-body").scrollTo({top:0,behavior:"smooth"}),jQuery(r.instance.previewModal).modal("hide")):r.instance.showTemplateMessage(i,e.message):window.location.href=e.redirect,document.body.classList.remove("tf-templates-library-inserting"),i&&i.classList.remove("inserting-template"),s.classList.remove("working")}))},t.getCurrentItems=function(e){var t=".tf-library-list > .tf-library-item:not(.blank_popup):not(.ignore)";return(e=void 0===e?!1:e)&&(t+=":not(.is-hidden)"),this.instance.library_wrapper.querySelectorAll(t)},e}(),TF_Templates_Library=function(){function e(){this.observer=null,this.ready=!1,this.JoomlaOptions=null,this.onReady()}var t=e.prototype;return t.onReady=function(){var t;window.MutationObserver&&((t=this).observer=new MutationObserver(function(e){if(e)for(m in e){if(t.ready)return;e[m].target.closest(".tf-templates-library")&&(t.init(),t.ready=!0)}}),this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0}))},t.init=function(){this.observer.disconnect(),this.modal=document.querySelector(".tf-templates-library"),this.isJ4=this.modal.classList.contains("isJ4"),this.library_wrapper=document.querySelector(".tf-library-page"),this.library_noresults=document.querySelector(".tf-library-no-results"),this.library_list=document.querySelector(".tf-library-list"),this.library_toolbar=this.library_wrapper.querySelector(".tf-library-toolbar"),this.library_messages=this.library_wrapper.querySelector(".tf-library-messages"),this.sidebar_element=this.library_wrapper.querySelector(".tf-library-sidebar"),this.filters_sidebar=this.sidebar_element.querySelector(".tf-library-sidebar-filters"),this.previewModal=document.querySelector(".tf-templates-library-popup-preview"),this.modals=new TF_Templates_Library_Modals(this),this.items=new TF_Templates_Library_Items(this),this.toolbar=new TF_Templates_Library_Toolbar(this),this.filters=new TF_Templates_Library_Filters(this),this.search=new TF_Templates_Library_Search(this),this.sidebar=new TF_Templates_Library_Sidebar(this),this.info_modal=new TF_Templates_Info_Modal(this),this.sorting=new TF_Templates_Library_Sorting(this),this.preview_modal=new TF_Templates_Preview_Modal(this),this.prepare(),this.initEvents()},t.prepare=function(){this.isJ4&&document.body.classList.add("isJ4")},t.initEvents=function(){var e=this;jQuery(this.modal).on("show.bs.modal",function(){e.loadTemplates()}),document.addEventListener("click",function(e){this.handleRefreshTemplates(e),this.onMessageHide(e),this.toggleFullscreenMode(e)}.bind(this))},t.onMessageHide=function(e){e.target.closest(".tf-library-messages-hide-btn")&&(this.library_messages.classList.add("is-hidden"),this.library_messages.querySelector(".tf-library-messages-text").innerHTML="")},t.toggleFullscreenMode=function(e){var t=e.target.closest(".tf-templates-library-toggle-fullscreen");t&&(e.preventDefault(),this.modal.classList.toggle("fullscreen"),t.classList.toggle("fullscreen"))},t.getOption=function(e,t){t=void 0===t?"":t;var i=this.getJoomlaOption("tassos_framework");return i&&void 0!==i[e]?i[e]:t},t.getJoomlaOption=function(e,t){if(!this.JoomlaOptions){var i=document.querySelector(".joomla-script-options");if(!i)return;this.JoomlaOptions=JSON.parse(i.text||i.textContent)}return void 0!==this.JoomlaOptions[e]?this.JoomlaOptions[e]:t},t.ajaxCall=function(e,t,i){t.options=this.library_wrapper.dataset.options;e=this.getOption("templates_library_ajax_url")+"&action="+e+"&"+this.getOption("csrf_token")+"=1";fetch(e,{method:"post",body:JSON.stringify(t)}).then(function(e){return e.json()}).then(function(e){i(e)}).catch(function(e){console.log(e),alert(e)})},t.loadTemplates=function(){if(this.library_wrapper.classList.contains("loaded"))return!1;var t=this.modal.querySelector(".tf-templates-refresh-btn"),i=(t.classList.add("working"),this.resetTemplatesLayout(),this);this.ajaxCall("get_templates",{},function(e){i.updateLibraryLayout(e),t.classList.remove("working")})},t.handleRefreshTemplates=function(e){var t,i=e.target.closest(".tf-templates-refresh-btn");i&&(e.preventDefault(),t=this,i.classList.add("working"),this.resetTemplatesLayout(),this.ajaxCall("refresh_templates",{},function(e){t.updateLibraryLayout(e),i.classList.remove("working"),e.code||e.message||(i.classList.add("checkmark"),setTimeout(function(){i.classList.remove("checkmark")},2e3))}))},t.updateLibraryLayout=function(e){var t="";e?e.error&&e.message&&(t=e.message):t="Cannot load templates",t?(this.showMessageAlert(t),this.modal.querySelector(".tf-library-body").scrollTo({top:0,behavior:"smooth"})):(this.library_list.querySelectorAll(".tf-library-item:not(.blank_popup)").forEach(function(e){e.remove()}),this.library_wrapper.classList.add("loaded"),this.library_list.innerHTML+=e.templates,e.filters?(this.library_wrapper.classList.remove("no-sidebar"),this.filters_sidebar.innerHTML=e.filters):this.library_wrapper.classList.add("no-sidebar"),this.filters.update())},t.resetTemplatesLayout=function(){this.hideMessageAlert(),document.querySelector(".tf-library-list").classList.remove("is-hidden"),document.querySelector(".tf-library-no-results").classList.remove("is-visible")},t.hideMessageAlert=function(){this.library_messages.classList.add("is-hidden")},t.showTemplateMessage=function(e,t){e=e.querySelector(".tf-template-item-message");t&&(e.querySelector(".tf-template-item-message-text").innerHTML=t),e.classList.remove("is-hidden")},t.showMessageAlert=function(e){e&&(this.library_messages.querySelector(".tf-library-messages-text").innerHTML=e),this.library_messages.classList.remove("is-hidden")},t.getTemplateItem=function(e){var t=e.dataset.templateId;return t?this.library_list.querySelector('.tf-library-item[data-id="'+t+'"]'):e.closest(".tf-library-item")},e}();function _createForOfIteratorHelperLoose(e,t){var i,r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return r&&(e=r),i=0,function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var i;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(i="Object"===(i=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:i)||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}document.addEventListener("DOMContentLoaded",function(){new TF_Templates_Library});var TF_Templates_Library_Modals=function(){function e(e){this.instance=e,this.popupsClasses=["tf-pro-only-modal","tf-templates-library","tf-templates-library-item-info","tf-templates-library-popup-preview"],this.tabindex=1,this.prepareModals(),this.initEvents()}var t=e.prototype;return t.prepareModals=function(){var i=this;this.popupsClasses.forEach(function(e){var t=document.querySelector("."+e);t&&(t.tfTabIndex=i.tabindex,i.tabindex++,t.setAttribute("aria-hidden",!0),t.setAttribute("data-backdrop","static"),t.setAttribute("data-bs-backdrop","static"),t.setAttribute("data-keyboard",!1),t.setAttribute("data-bs-keyboard",!1),t.classList.contains("isJ4")?(t.setAttribute("tabindex",-1),new bootstrap.Modal("."+e,{backdrop:"static",keyboard:!1})):(t.removeAttribute("tabindex"),jQuery(t).modal({show:!1,backdrop:"static",keyboard:!1})))})},t.initEvents=function(){var i=this;document.addEventListener("keydown",function(e){this.handleEscapeClose(e)}.bind(this)),jQuery(window).on("show.bs.modal",function(t){i.popupsClasses.forEach(function(e){t.target.classList.contains(e)&&(document.querySelector(".modal."+e).tfTabIndex=i.tabindex,i.tabindex++,document.body.classList.add("tf-modal-"+e+"-open"))})}),jQuery(window).on("hide.bs.modal",function(t){i.popupsClasses.forEach(function(e){t.target.classList.contains(e)&&document.body.classList.remove("tf-modal-"+e+"-open")}),"ebSelectTemplate"===t.target.id&&(i.popupsClasses.forEach(function(e){var t=document.querySelector("."+e);t&&(t.classList.remove("in","show"),document.body.classList.remove("tf-modal-"+e+"-open"))}),document.querySelectorAll(".modal-backdrop").forEach(function(e){e.remove()}))})},t.handleEscapeClose=function(e){if(27==(e=e||window.event).keyCode){if(e.preventDefault(),document.querySelector(".modal.tf-pro-only-modal.fade.in")||document.querySelector(".modal.tf-pro-only-modal.fade.show"))return!1;e=this.getAllVisibleModals();if(e.length){for(var t=null,i=-1,r=_createForOfIteratorHelperLoose(e);!(s=r()).done;){var s=s.value;s.classList.contains("tf-pro-only-modal")||void 0!==s.tfTabIndex&&s.tfTabIndex>i&&(i=s.tfTabIndex,t=s)}t&&jQuery(t).modal("hide")}}},t.getAllVisibleModals=function(){var i=[];return this.popupsClasses.forEach(function(e){var t=document.querySelector("."+e+".fade.in");(t=t||document.querySelector("."+e+".fade.show"))&&i.push(t)}),i},e}(),TF_Templates_Preview_Modal=function(){function e(e){this.instance=e,this.previewing=!1,this.modal=document.querySelector("#tf-library-preview-popup"),this.initEvents()}var t=e.prototype;return t.initEvents=function(){window.addEventListener("hashchange",function(e){"#templates-library-previewer"===window.location.hash&&(this.previewing=!0),this.previewing&&""===window.location.hash&&jQuery(this.modal).modal("hide")}.bind(this)),jQuery(this.modal).on("hide.bs.modal",function(e){this.onBeforeClose()}.bind(this)),document.addEventListener("click",function(e){this.onBeforeOpen(e),this.toggleResponsiveViewport(e),this.refreshDemo(e)}.bind(this))},t.onBeforeOpen=function(e){var t,i,e=e.target.closest(".tf-library-preview-item");e&&(jQuery(this.modal).modal("show"),e=this.instance.getTemplateItem(e),this.modal.querySelector(".modal-title").innerHTML=e.querySelector(".template-label").innerHTML,i=e.querySelector(".tf-library-template-item-info").cloneNode(!0),this.modal.querySelector(".modal-header .tf-library-template-item-info")&&this.modal.querySelector(".modal-header .tf-library-template-item-info").remove(),e.classList.contains("has-errors")&&i.classList.add("has-errors"),this.modal.querySelector(".modal-header .modal-title-wrapper").appendChild(i),i=(i=this.instance.library_wrapper.dataset.previewUrl).replace("TEMPLATE_ID",e.dataset.id),this.modal.querySelector("iframe")?((t=this.modal.querySelector("iframe").cloneNode()).src=i,this.modal.querySelector("iframe").parentNode.replaceChild(t,this.modal.querySelector("iframe"))):((t=document.createElement("iframe")).className="tf-library-preview-iframe",t.src=i,this.modal.querySelector(".tf-library-preview-inner").appendChild(t)),this.modal.querySelector("iframe").addEventListener("load",this.onIframeLoaded.bind(this),!0),this.setViewport("desktop"),i=e.querySelector(".tf-library-item-actions a").cloneNode(!0),this.modal.querySelector(".modal-header .tf-library-preview-action")&&this.modal.querySelector(".modal-header .tf-library-preview-action").remove(),i.classList.add("tf-library-preview-action","tf-button","outline"),i.classList.contains("red")||(e.classList.contains("has-errors")?i.classList.add("orange"):i.classList.add("blue")),this.modal.querySelector(".modal-header .actions-wrapper").insertBefore(i,this.modal.querySelector(".modal-header .actions-wrapper").firstChild))},t.onIframeLoaded=function(){this.modal.classList.remove("refreshing")},t.onBeforeClose=function(){this.previewing=!1,window.location.hash="";var e=this.getIFrame();e&&(e.removeEventListener("load",this.onIframeLoaded),e.src="")},t.refreshDemo=function(e){var t;e.target.closest(".tf-templates-library-refresh-demo")&&(e.preventDefault(),this.modal.querySelector("iframe").removeEventListener("load",this.onIframeLoaded),this.modal.classList.add("refreshing"),(t=(e=this.getIFrame()).cloneNode()).addEventListener("load",this.onIframeLoaded.bind(this),!0),t.src=e.src,e.parentNode.replaceChild(t,e))},t.getIFrame=function(){return this.modal.querySelector("iframe")},t.toggleResponsiveViewport=function(e){e=e.target.closest(".tf-templates-library-preview-responsive-device");e&&this.setViewport(e.dataset.device)},t.setViewport=function(e){var t=this.getIFrame();this.modal.querySelector(".tf-templates-library-preview-responsive-device.active").classList.remove("active"),this.modal.querySelector('.tf-templates-library-preview-responsive-device[data-device="'+e+'"]').classList.add("active"),t.classList.remove("desktop","tablet","mobile"),t.classList.add(e)},e}(),TF_Templates_Library_Search=function(){function e(e){this.instance=e}var t=e.prototype;return t.search=function(){var i=this.getSearchTerm(),r=this.instance.library_toolbar.querySelector(".tf-library-view-favorites.active");this.instance.items.getCurrentItems(!0).forEach(function(e){var t=!0;i&&(t=!1,e.dataset.title.toLowerCase().includes(i)&&(t=!0),e.dataset.filterCategory.toLowerCase().includes(i)&&(t=!0),e.dataset.filterTags.toLowerCase().includes(i)&&(t=!0),e.dataset.filterSolution.toLowerCase().includes(i)&&(t=!0),e.dataset.filterGoal.toLowerCase().includes(i))&&(t=!0),(t=!r||e.querySelector(".tf-library-favorite-item")&&e.querySelector(".tf-library-favorite-item").classList.contains("active")?t:!1)?e.classList.remove("is-hidden"):e.classList.add("is-hidden")}),this.updateSearchElements()},t.updateSearchElements=function(){var e,t=this.instance.items.getCurrentItems(!0).length,t=(0===t?(this.instance.library_noresults.classList.add("is-visible"),this.instance.library_list.classList.add("is-hidden")):(this.instance.library_noresults.classList.remove("is-visible"),this.instance.library_list.classList.remove("is-hidden")),this.instance.library_wrapper.querySelector(".tf-showing-results-counter").innerHTML=t,this.instance.filters.onUpdateSearchElements(),this.getSearchTerm());t&&(this.instance.filters.setHasFilters(),(e=this.instance.library_wrapper.querySelector(".tf-library-filter-template").cloneNode(!0)).querySelector(".filter").classList.add("search-filter-pill"),e.querySelector(".filter svg").remove(),e.querySelector(".filter .filter-label").textContent='"'+t+'"',this.instance.filters.getFilterPillsWrapper().appendChild(e.children[0]))},t.getSearchTerm=function(){return this.instance.library_toolbar.querySelector("#tf_search_template").value.trim().toLowerCase()},e}(),TF_Templates_Library_Sidebar=function(){function e(e){this.instance=e,this.items=this.instance.items,this.toolbar=this.instance.toolbar,this.initEvents()}var t=e.prototype;return t.initEvents=function(){this.onPageLoadToggle(),document.addEventListener("click",function(e){this.initSidebarToggle(e)}.bind(this))},t.initSidebarToggle=function(e){e.target.closest(".tf-library-sidebar-toggle")&&(e.preventDefault(),this.instance.modal.classList.toggle("sidebar-open"),e=this.getLibraryID(),this.instance.modal.classList.contains("sidebar-open")?window.localStorage.setItem(e,"open"):(window.localStorage.removeItem(e),this.instance.sidebar_element.scrollTo({top:0,behavior:"smooth"})))},t.getLibraryID=function(){return"templates_library_"+this.instance.modal.id},t.onPageLoadToggle=function(){window.localStorage.getItem(this.getLibraryID())?this.instance.modal.classList.add("sidebar-open"):this.instance.modal.classList.remove("sidebar-open")},e}(),TF_Templates_Library_Sorting=function(){function e(e){this.instance=e,this.sortWrapper=this.instance.library_toolbar.querySelector(".sorting-selector-item"),this.initEvents()}var t=e.prototype;return t.initEvents=function(){document.addEventListener("click",function(e){this.onSortUpdate(e),this.onSortHide(e)}.bind(this)),this.sortWrapper.addEventListener("mouseover",function(e){this.onSortingShow(e)}.bind(this)),this.sortWrapper.addEventListener("mouseout",function(e){this.onSortingMouseOutHide(e)}.bind(this))},t.onSortingMouseOutHide=function(e){(e.target.closest(".sorting-selected-label")||e.target.closest(".sorting-selector-items"))&&this.sortWrapper.classList.remove("visible")},t.onSortUpdate=function(e){var t;e.target.closest(".sorting-selector-items")&&(t=e.target.closest("li"))&&!t.classList.contains("selected")&&(e.preventDefault(),this.sortWrapper.classList.remove("visible"),this.sortWrapper.querySelector(".sorting-selector-items li.selected").classList.remove("selected"),t.classList.add("selected"),this.sortWrapper.querySelector(".sorting-selected-label .selected-label").innerHTML=t.innerHTML,this.sort())},t.sort=function(){var r=this,s=this.sortWrapper.querySelector(".sorting-selector-items li.selected").dataset.value,e=this.instance.items.getCurrentItems(!0);e.forEach(function(e){e.style.order=null});e=Array.from(e).sort(function(e,t){var i="sort"+r.capitalizeFirstLetter(s);return"date"===s?e.dataset[i].localeCompare(t.dataset[i]):parseInt(e.dataset[i],10)<=parseInt(t.dataset[i],10)?-1:1});var e=[].concat(e).reverse(),t=1;e.forEach(function(e){e.style.order=t,t++})},t.onSortHide=function(e){e.target.closest(".sorting-selector-item")||this.sortWrapper.classList.remove("visible")},t.onSortingShow=function(e){e.target.closest(".sorting-selector-item")&&this.sortWrapper.classList.add("visible")},t.capitalizeFirstLetter=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},e}(),TF_Templates_Library_Toolbar=function(){function e(e){this.instance=e,this.initEvents()}var t=e.prototype;return t.initEvents=function(){document.addEventListener("input",function(e){this.onInputSearch(e)}.bind(this)),document.addEventListener("click",function(e){this.onFavoritesView(e)}.bind(this))},t.onInputSearch=function(e){e.target.closest("#tf_search_template")&&(e.target.value.trim(),this.instance.filters.update())},t.onFavoritesView=function(e){var t=e.target.closest(".tf-library-view-favorites");t&&(t.classList.toggle("active"),this.instance.library_wrapper.classList.toggle("favorites-view"),this.instance.filters.update(),e.preventDefault())},e}();

